<script type="text/javascript">
// Bind form-related events and callbacks
$( document ).ready(function() {
  // Initial setup for required fields
  $(".form-control-required").each(function(index) {
    var strValue = $(this).val().replace(/^ +/g, "").replace(/ +$/g, "");
    if (strValue == "")
    {
      $(this).parent().addClass("has-error");
    }
  });
  // Check required fields when losing focus
  $(".form-control-required").on('focusout', function(event) {
    // Validate required field: MUST NOT be empty on focus out (otherwise we set the error class)
    var strValue = $(event.target).val().replace(/^ +/g, "").replace(/ +$/g, "");
    if (strValue == "")
    {
      $(event.target).parent().addClass("has-error").removeClass("has-success has-warning");
    }
    else
    {
      $(event.target).parent().removeClass("has-error has-warning").addClass("has-success");
    }
  });
  $("#_CANCEL").on('click', function(event) {
    // Remove all errors so that submit event can be processed without validation
    $(".has-error").removeClass("has-error");
  });
  $("#_FORM_NEW").on('submit', function(event) {
    var objErrors = $(".has-error");
    var blnValue = (objErrors.length == 0);
    if(!blnValue)
    {
      event.preventDefault();
      // Set focus on first field in error
      objErrors[0].focus();
    }
  });
  $("#_ADD").on('click', function(event) {
    // Redirect to new form
    window.location.href = "new";
  });
  $("#_MODIFY").on('click', function(event) {
    // Change form action
    $("#_FORM_VIEW").attr("action", "update");
    // Enable fieldset under form
    $("#_FORM_VIEW > fieldset").prop("disabled", false);
    // Disable Add/Modify/Delete buttons
    $("#_ADD").prop("disabled", true);
    $("#_MODIFY").prop("disabled", true);
    $("#_DELETE").prop("disabled", true);
    // Show OK/Cancel buttons
    $("#_OK_CANCEL").removeClass("hidden").addClass("show");
  });
  $("#_DELETE").on('click', function(event) {
    // Change form action
    $("#_FORM_VIEW").attr("action", "delete");
    // Let fieldset disabled
    // Disable Add/Modify/Delete buttons
    $("#_ADD").prop("disabled", true);
    $("#_MODIFY").prop("disabled", true);
    $("#_DELETE").prop("disabled", true);
    // Show OK/Cancel buttons
    $("#_OK_CANCEL").removeClass("hidden").addClass("show");
  });
});
</script>
